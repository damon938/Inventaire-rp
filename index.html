<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventaire RPG</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Poppins:wght@400;600&display=swap');

body {
  background: linear-gradient(135deg, #0d1b2a, #1b263b);
  font-family: 'Poppins', sans-serif;
  color: #e0e0e0;
  margin: 0;
  padding: 20px;
}

h1 { color: #00b4d8; text-align:center; }
#playerName {
  font-family: 'Cinzel Decorative', cursive;
  font-size: 2.8em;
  color: #ffd36b;
  text-align: center;
  margin: 15px 0 25px 0;
  text-shadow: 2px 2px 6px #000;
}

input, button {
  padding: 10px;
  border-radius: 10px;
  border: none;
  margin: 5px;
}

button { background:#0077b6; color:#fff; cursor:pointer; }
button:hover { background:#00b4d8; }

.items {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-top: 20px;
}

.item-card {
  display: grid;
  grid-template-columns: 2fr 1.5fr 1fr 1fr auto;
  border-radius: 15px;
  padding: 12px;
  align-items: center;
  box-shadow: 0 0 15px rgba(0,0,0,0.5);
  background: linear-gradient(135deg, rgba(20,40,80,0.8), rgba(50,70,120,0.9));
}

/* Vagues de couleur pour chaque colonne */
.item-card div:nth-child(1){ background: rgba(0,180,216,0.2); padding:4px 6px; border-radius:8px; font-weight:600; font-size:1.1em;}
.item-card div:nth-child(2){ background: rgba(144,224,239,0.2); padding:4px 6px; border-radius:8px; font-style:italic;}
.item-card div:nth-child(3){ background: rgba(255,100,100,0.2); padding:4px 6px; border-radius:8px; text-align:center;}
.item-card div:nth-child(4){ background: rgba(100,255,100,0.2); padding:4px 6px; border-radius:8px; text-align:center;}
.item-card div:nth-child(5){ text-align:center; }

.tag {
  padding: 5px 10px;
  border-radius: 999px;
  font-size: 13px;
  font-weight: bold;
}

.common{background:#cbd5df;color:#042433;}
.uncommon{background:#7ad29e;color:#042215;}
.rare{background:#7fb4ff;color:#042033;}
.epic{background:#bf9bff;color:#2a083a;}
.legendary{background:#ffd36b;color:#42310a;}
</style>
</head>
<body>

<h1>Inventaire RPG</h1>
<input id="playerId" placeholder="Entrez ID ex: ARK001">
<button id="btnSearch">Afficher</button>
<h2 id="playerName"></h2>

<div class="items" id="items"></div>

<script>
const API = 'https://sheetdb.io/api/v1/gyzos0qguzqsv';

// Convertit la rareté en classe CSS
function rarityClass(r){
  if(!r) return 'common';
  const rr = String(r).toLowerCase();
  if(rr.includes('lég') || rr.includes('leg')) return 'legendary';
  if(rr.includes('épi') || rr.includes('epic')) return 'epic';
  if(rr.includes('ra') || rr.includes('rare')) return 'rare';
  if(rr.includes('peu') || rr.includes('unco')) return 'uncommon';
  return 'common';
}

async function loadInventory(){
  const id = document.getElementById('playerId').value.trim();
  const itemsEl = document.getElementById('items');
  itemsEl.innerHTML = '';

  if(!id){ itemsEl.innerHTML='<p>Veuillez entrer un ID.</p>'; return; }

  try{
    const res = await fetch(`${API}/search?id=${encodeURIComponent(id)}`);
    const rows = await res.json();

    if(!rows || rows.length===0){
      itemsEl.innerHTML='<p>Aucun objet trouvé pour cet ID.</p>';
      return;
    }

    const joueurNom = rows[0]["Nom"] || "Inconnu";
    document.getElementById("playerName").textContent = `${joueurNom}`;

    rows.forEach(r=>{
      const item = {
        nom: r["nom de l'objet "] || 'Objet sans nom',
        type: r["type d'objet "] || '—',
        rarete: r["rareté "] || 'Commun',
        quantite: r["quantité "] || '1',
        valeur: r["valeur lunaris "] || '0'
      };

      const div = document.createElement('div');
      div.className='item-card';
      div.innerHTML = `
        <div>${item.nom}</div>
        <div>${item.type}</div>
        <div>${item.quantite}</div>
        <div>${item.valeur} Lunaris</div>
        <div><span class="tag ${rarityClass(item.rarete)}">${item.rarete}</span></div>
      `;
      itemsEl.appendChild(div);
    });

  }catch(err){
    console.error(err);
    itemsEl.innerHTML='<p>Erreur lors de la récupération des données.</p>';
  }
}

document.getElementById('btnSearch').addEventListener('click', loadInventory);
document.getElementById('playerId').addEventListener('keydown', e=>{ if(e.key==='Enter') loadInventory(); });
</script>

</body>
  </html>
