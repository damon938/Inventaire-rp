<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inventaire RPG</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Poppins:wght@400;600&display=swap');

body {
  background: linear-gradient(135deg, #0d1b2a, #1b263b);
  font-family: 'Poppins', sans-serif;
  color: #e0e0e0;
  margin: 0;
  padding: 20px;
}

h1 { color: #00b4d8; text-align:center; }
h2 { color: #90e0ef; text-align:center; margin-top:10px; }

input, button {
  padding: 10px;
  border-radius: 10px;
  border: none;
  margin: 5px;
}

button { background:#0077b6; color:#fff; cursor:pointer; }
button:hover { background:#00b4d8; }

.items {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 20px;
}

.item-card {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr auto;
  background: rgba(255,255,255,0.05);
  border-radius: 10px;
  padding: 10px;
  align-items: center;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

.item-card div { padding: 4px 6px; overflow-wrap: break-word; }

.tag {
  padding: 4px 8px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: bold;
  text-align:center;
}

.common{background:#cbd5df;color:#042433;}
.uncommon{background:#7ad29e;color:#042215;}
.rare{background:#7fb4ff;color:#042033;}
.epic{background:#bf9bff;color:#2a083a;}
.legendary{background:#ffd36b;color:#42310a;}
</style>
</head>
<body>

<h1>Inventaire RPG</h1>
<input id="playerId" placeholder="Entrez ID ex: ARK001">
<button id="btnSearch">Afficher</button>
<h2 id="playerName"></h2>

<div class="items" id="items"></div>

<script>
const API = 'https://sheetdb.io/api/v1/gyzos0qguzqsv';

// Convertit la rareté en classe CSS
function rarityClass(r){
  if(!r) return 'common';
  const rr = String(r).toLowerCase();
  if(rr.includes('lég') || rr.includes('leg')) return 'legendary';
  if(rr.includes('épi') || rr.includes('epic')) return 'epic';
  if(rr.includes('ra') || rr.includes('rare')) return 'rare';
  if(rr.includes('peu') || rr.includes('unco')) return 'uncommon';
  return 'common';
}

async function loadInventory(){
  const id = document.getElementById('playerId').value.trim();
  const itemsEl = document.getElementById('items');
  itemsEl.innerHTML = '';

  if(!id){ itemsEl.innerHTML='<p>Veuillez entrer un ID.</p>'; return; }

  try{
    const res = await fetch(`${API}/search?id=${encodeURIComponent(id)}`);
    const rows = await res.json();

    if(!rows || rows.length===0){
      itemsEl.innerHTML='<p>Aucun objet trouvé pour cet ID.</p>';
      return;
    }

    const joueurNom = rows[0]["Nom"] || "Inconnu";
    document.getElementById("playerName").textContent = `Inventaire de ${joueurNom}`;

    rows.forEach(r=>{
      const item = {
        nom: r["nom de l'objet "] || 'Objet sans nom',
        type: r["type d'objet "] || '—',
        rarete: r["rareté "] || 'Commun',
        quantite: r["quantité "] || '1',
        valeur: r["valeur lunaris "] || '0'
      };

      const div = document.createElement('div');
      div.className='item-card';
      div.innerHTML = `
        <div><strong>${item.nom}</strong></div>
        <div>${item.type}</div>
        <div>${item.quantite}</div>
        <div>${item.valeur} Lunaris</div>
        <div><span class="tag ${rarityClass(item.rarete)}">${item.rarete}</span></div>
      `;
      itemsEl.appendChild(div);
    });

  }catch(err){
    console.error(err);
    itemsEl.innerHTML='<p>Erreur lors de la récupération des données.</p>';
  }
}

document.getElementById('btnSearch').addEventListener('click', loadInventory);
document.getElementById('playerId').addEventListener('keydown', e=>{ if(e.key==='Enter') loadInventory(); });
</script>

</body>
                                 </html>
